\documentclass{standalone}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[french]{babel}
\usepackage{eulervm}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usetikzlibrary{decorations.pathmorphing}
\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{groupplots}
\usetikzlibrary{matrix, positioning, patterns}
\usepackage{pgffor}
\usepackage{amsmath}

\setlength{\textwidth}{146.8mm}
\input{../../../colors}

\begin{document}

\begin{tikzpicture}
		
		\begin{groupplot}[group style={group name=be, group size= 2 by 4, horizontal sep=1.7cm, vertical sep=3cm}, 
					height=0.4\textwidth,  width=0.7\textwidth,
					grid=both, grid style={gray!30},
					colorbrewer cycle list=Spectral,
					ybar interval=1pt, %/pgf/bar width=3pt,
					xmin=1, xmax=22, xtick={1,2,...,22}, ymin=0,  ytick={0,10,...,45}, ymax=45, 
					grid=both, grid style={dashed, gray!50},  legend style={at={(0.5,1.1)},anchor=south},legend columns=4,
					xticklabels={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,>20},
					 x tick label style={shift={(axis cs:1.3,0)},anchor=east,rotate=60},
					 ylabel=FdM (\%),
					     restrict y to domain*=0:45, % Cut values off at 14
    visualization depends on=rawy\as\rawy, % Save the unclipped values
    after end axis/.code={ % Draw line indicating break
            \draw [ultra thick, white, decoration={snake, amplitude=1pt}, decorate] (rel axis cs:0,0.95) -- (rel axis cs:1,0.95);
        },
    axis lines*=left,
    clip=false 
					 ]
	 
		\nextgroupplot[legend entries = {1.1dB, 1.4dB, 1.7dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YB_11] {../dat/752_13};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YB_14] {../dat/752_13};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YB_17] {../dat/752_13};
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=13_be] {../dat/th752_w};
		%\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-4 }, update limits=false] table[x=X, y=13_be] {../dat/th752};
		\addplot [<-, black, very thin, sharp plot, update limits=false] coordinates{(9.95,60) (10.4,60)} node [right] {{\footnotesize $55$}};

		\nextgroupplot[legend entries = {1.1dB, 1.4dB, 1.7dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YS_11] {../dat/752_13};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YS_14] {../dat/752_13};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YS_17] {../dat/752_13};
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=13_se] {../dat/th752_w};
 		%\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-4 }, update limits=false] table[x=X, y=13_se] {../dat/th752};
 		\addplot [<-, black, very thin, sharp plot, update limits=false] coordinates{(6.95,60) (7.4,60)} node [right] {{\footnotesize $58$}};

 		\nextgroupplot[legend entries = {1.6dB, 2.0dB, 2.4dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YB_15] {../dat/752_12};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YB_18] {../dat/752_12};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YB_21] {../dat/752_12};
		\node[rotate=60] at ($(axis cs:10.75,48)+(0,0)$) {\small \textcolor{Paired-5}{45}}; 
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=12_be] {../dat/th752_w};
		%\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-4 }, update limits=false] table[x=X, y=12_be] {../dat/th752};
		\addplot [<-, black, very thin, sharp plot, update limits=false] coordinates{(9.95,60) (10.4,60)} node [right] {{\footnotesize $68$}};

		\nextgroupplot[legend entries = {1.6dB, 2.0dB, 2.4dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YS_15] {../dat/752_12};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YS_18] {../dat/752_12};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YS_21] {../dat/752_12};
		\node[rotate=60] at ($(axis cs:7.75,48)+(0,0)$) {\small \textcolor{Paired-5}{54}}; 
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=12_se] {../dat/th752_w};
		%\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-4 }, update limits=false] table[x=X, y=12_se] {../dat/th752};
		\addplot [<-, black, very thin, sharp plot, update limits=false] coordinates{(6.95,60) (7.4,60)} node [right] {{\footnotesize $92$}};

		\nextgroupplot[legend entries = {3.2dB, 3.6dB, 4.0dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YB_29] {../dat/752_34};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YB_32] {../dat/752_34};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YB_35] {../dat/752_34};
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=34_be] {../dat/th752_w};

		\nextgroupplot[legend entries = {3.2dB, 3.6dB, 4.0dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YS_29] {../dat/752_34};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YS_32] {../dat/752_34};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YS_35] {../dat/752_34};
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=34_se] {../dat/th752_w};

		\nextgroupplot[legend entries = {4.4dB, 4.8dB, 5.2dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YB_41] {../dat/752_67};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YB_44] {../dat/752_67};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YB_47] {../dat/752_67};
		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=67_be] {../dat/th752_w};


		\nextgroupplot[legend entries = {4.4dB, 4.8dB, 5.2dB}]
		\addplot[draw=Paired-1, fill=Paired-1!50, postaction={pattern color = black!80,pattern=north west lines}] table [x=X, y=YS_41] {../dat/752_67};
		\addplot[draw=Paired-3, fill=Paired-3!50, postaction={pattern color = black!80,pattern=north east lines}] table [x=X, y=YS_44] {../dat/752_67};
		\addplot[draw=Paired-5, fill=Paired-5!50, postaction={pattern color = black!80,pattern=crosshatch dots }] table [x=X, y=YS_47] {../dat/752_67};
 		\addplot[mark=*, only marks, black, mark options={scale=0.9, fill=Dark2-2!50 }, update limits=false] table[x=X, y=67_se] {../dat/th752_w};
 			\addplot [<-, black, very thin, sharp plot, update limits=false] coordinates{(4.95,60) (5.4,60)} node [right] {{\footnotesize $46$}};
				
\end{groupplot}
		\node[below = 0.8cm of be c1r1.south] {(a) : DVB-RCS - K=752 R=1/3 - BE};
		\node[below = 0.8cm of be c2r1.south] {(b) : DVB-RCS - K=752 R=1/3 - SE};
		\node[below = 0.8cm of be c1r2.south] {(c) : DVB-RCS - K=752 R=1/2 - BE};
		\node[below = 0.8cm of be c2r2.south] {(d) : DVB-RCS - K=752 R=1/2 - SE};
		\node[below = 0.8cm of be c1r3.south] {(e) : DVB-RCS - K=752 R=3/4 - BE};
		\node[below = 0.8cm of be c2r3.south] {(f) : DVB-RCS - K=752 R=3/4 - SE};
		\node[below = 0.8cm of be c1r4.south] {(g) : DVB-RCS - K=752 R=6/7 - BE};
		\node[below = 0.8cm of be c2r4.south] {(h) : DVB-RCS - K=752 R=6/7 - SE};
\end{tikzpicture}  

\end{document}
